/*
    C code file Generated by InterNiche Technologies MIB Compiler
    Copyright 1993-1999 by InterNiche Technologies
*/
/*****************************************************************************/
/** Copyright 1990-96 by NetPort Software. All rights reserved.              */
/** Copyright 1996-2002 By InterNiche Technologies Inc. All rights reserved. */
/*  Copyright (C) 2019 Siemens Aktiengesellschaft. All rights reserved.      */
/*****************************************************************************/
/*  This program is protected by German copyright law and international      */
/*  treaties. The use of this software including but not limited to its      */
/*  Source Code is subject to restrictions as agreed in the license          */
/*  agreement between you and Siemens.                                       */
/*  Copying or distribution is not allowed unless expressly permitted        */
/*  according to your license agreement with Siemens.                        */
/*****************************************************************************/
/*                                                                           */
/*  P r o j e c t         &P: Layer Stack Architecture (LSA)    :P&          */
/*                                                                           */
/*  P a c k a g e         &W: SNMPX                             :W&          */
/*                                                                           */
/*  C o m p o n e n t     &C: SNMPX                             :C&          */
/*                                                                           */
/*  F i l e               &F: snmpx_mibs.c                      :F&          */
/*                                                                           */
/*  V e r s i o n         &V: BC_PNRUN_P07.01.00.00_00.02.00.15 :V&          */
/*                                                                           */
/*  D a t e  (YYYY-MM-DD) &D: 2019-08-05                        :D&          */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/*  D e s c r i p t i o n:  SNMPX SNMP-Agent functions                       */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/*  H i s t o r y :                                                          */
/*  ________________________________________________________________________ */
/*                                                                           */
/*  Date        Who   What                                                   */
/*  20.07.04    VE    initial version.                                       */
/*****************************************************************************/

#define LTRC_ACT_MODUL_ID 18

#define SNMPX_MODULE_ID     LTRC_ACT_MODUL_ID /* SNMPX_MODULE_ID_SNMPX_MIBS */

/*===========================================================================*/
/*                                 includes                                  */
/*===========================================================================*/

#include "snmpx_inc.h"            /* SNMPX headerfiles  */
#include "snmpx_int.h"            /* internal header    */

#if SNMPX_MODULE_ID_SNMPX_MIBS != SNMPX_MODULE_ID /* to avoid Lint warning 766 (header file not used) -- note: agent not yet implemented */
#error
#endif
#ifdef SNMPX_CFG_SNMP_AGENT

/* BTRACE-IF */
SNMPX_FILE_SYSTEM_EXTENSION(SNMPX_MODULE_ID)
#include "snmpx_asn1.h"
#include "snmpx_agnt.h"           /* SNMPX-Agent header */
#include "snmpx_snmp.h"           /* SNMP header        */

#include "snmpx_mibs.h"

/*===========================================================================*/
/*                                global Variables                           */
/*===========================================================================*/

struct snmpx_snmp_mib   SnmpxSnmpMib = {0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,2/*disabled*/};

/* SPLINT: Initializer does not define all elements of a declared array.     */
/*     Initializer block for snmpx_snmp_variables[0].name has 10 elements,   */
/*     but declared as DEF_VARLEN as unsigned long int [20],...              */

struct snmpx_variable snmpx_snmp_variables[] =
{
    {{1,3,6,1,2,1,11, 1,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINPKTS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11, 2,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTPKTS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11, 3,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINBADVERSIONS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11, 4,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINBADCOMMUNITYNAMES, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11, 5,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINBADCOMMUNITYUSES, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11, 6,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINASNPARSEERRS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11, 8,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINTOOBIGS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11, 9,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINNOSUCHNAMES, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,10,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINBADVALUES, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,11,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINREADONLYS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,12,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINGENERRS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,13,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINTOTALREQVARS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,14,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINTOTALSETVARS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,15,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINGETREQUESTS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,16,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINGETNEXTS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,17,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINSETREQUESTS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,18,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINGETRESPONSES, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,19,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPINTRAPS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,20,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTTOOBIGS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,21,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTNOSUCHNAMES, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,22,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTBADVALUES, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,24,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTGENERRS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,25,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTGETREQUESTS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,26,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTGETNEXTS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,27,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTSETREQUESTS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,28,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTGETRESPONSES, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,29,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_COUNTER, SNMPX_SNMPOUTTRAPS, SNMPX_READ_ONLY, snmpx_var_snmp },
    {{1,3,6,1,2,1,11,30,0, 0,0,0,0,0,0,0,0,0,0,0},  9, SNMPX_ASN_INTEGER, SNMPX_SNMPENABLEAUTHENTRAPS, SNMPX_READ_WRITE, snmpx_var_snmp },
};

int snmpx_snmp_num_variables = sizeof(snmpx_snmp_variables)/sizeof(struct snmpx_variable);

/* As variables[] is put in FAR_DATA segment, code that implements
   get_num_variables() and get_variables_arr() is compiler dependent.
   Hence it is put in a different file, called specific.c */

/* Microsoft compiler is not neat in handing int variables across
 * object files in a LARGE model. So when num_variables is accessed
 * in getStatPtr() in snmp.c, invalid data segment is used, and hence
 * incorrect value gets picked up. (Same is true with integer
 * pointers also). Hence this function.
 */

/* As sys_uptime[], snmptrapoid[] and snmpgenoid[] are used by
 * other files, its better to put a fixed size, instead of [].
 * Previously they were specified with [] and that made some compilers
 * (VC++ 6.0) generate bad code (sys_uptime would point to 0x01)
 * at point of use
 */
/* oid      sys_uptime[9] = { 1,3,6,1,2,1,1,3,0 } ;
   unsigned sys_uptime_len = sizeof ( sys_uptime )/sizeof(oid);
   oid      snmptrapoid[11] = { 1,3,6,1,6,3,1,1,4,1,0 } ;
   unsigned snmptrapoid_len = sizeof ( snmptrapoid )/sizeof(oid);
   oid      snmpgenoid[11] = { 1,3,6,1,6,3,1,1,5,1,0 } ;
*/

/*===========================================================================*/
/*                                functions                                  */
/*===========================================================================*/

/* FUNCTION: snmp_get_num_variables()
 *
 * PARAM1:
 *
 * RETURNS:
 */

int snmpx_snmp_get_num_variables(void)
{
    int   num=sizeof(snmpx_snmp_variables)/sizeof(struct  snmpx_variable);

    SNMPX_FUNCTION_TRACE_01(LSA_TRACE_LEVEL_CHAT, "IN/OUT: snmpx_snmp_get_num_variables(num:  0x%X)", num);
    return num;
}

/* FUNCTION: snmpx_get_variables_arr()
 *
 * PARAM1: void
 *
 * RETURNS:
 */

/* Borland compiler gives "fixup error" when variables[] is used in snmp.c
 * So, we will use get_variables_arr() to access variables[].
 */

#ifdef __BORLANDC__
struct snmpx_variable * _loadds snmpx_get_variables_arr(void)
#else
struct snmpx_variable *  snmpx_get_variables_arr(void)
#endif
{
    return   snmpx_snmp_variables;
}

/* 'var_' routine frames for variables table */

/* FUNCTION: var_snmp()
 *
 * PARAM1: struct variable * vp
 * PARAM2: oid *   name
 * PARAM3: int *   length
 * PARAM4: int      oper
 * PARAM5: int     var_len
 *
 * RETURNS:
 */

U_CHAR * snmpx_var_snmp(
    struct snmpx_variable * vp,   /* IN - pointer to variables[] entry */
    SNMPX_OID_TYPE *    name,       /* IN/OUT - input name requested; output name found */
    int *    length,  /* IN/OUT - length of input & output oids */
    int      oper,    /* IN - NEXT_OP (=0), GET_OP (=1), or SET_OP (=-1) */
    int *    var_len) /* OUT - length of variable, or 0 if function */
{
    U_CHAR * cp;

    if (oper && (snmpx_snmp_compare(name, *length, vp->name, (int)vp->namelen) != 0))
        return LSA_NULL;

    SNMPX_MEMCPY(name, vp->name, (int)vp->namelen * sizeof(SNMPX_OID_TYPE));
    *length = vp->namelen;
    *var_len = sizeof(long);   /* default length */

    cp = (U_CHAR*)&SnmpxSnmpMib;

    switch (vp->magic)
    {
        case SNMPX_SNMPINPKTS:
        case SNMPX_SNMPOUTPKTS:
        case SNMPX_SNMPINBADVERSIONS:
        case SNMPX_SNMPINBADCOMMUNITYNAMES:
        case SNMPX_SNMPINBADCOMMUNITYUSES:
        case SNMPX_SNMPINASNPARSEERRS:
        case SNMPX_SNMPINTOOBIGS:
        case SNMPX_SNMPINNOSUCHNAMES:
        case SNMPX_SNMPINBADVALUES:
        case SNMPX_SNMPINREADONLYS:
        case SNMPX_SNMPINGENERRS:
        case SNMPX_SNMPINTOTALREQVARS:
        case SNMPX_SNMPINTOTALSETVARS:
        case SNMPX_SNMPINGETREQUESTS:
        case SNMPX_SNMPINGETNEXTS:
        case SNMPX_SNMPINSETREQUESTS:
        case SNMPX_SNMPINGETRESPONSES:
        case SNMPX_SNMPINTRAPS:
        case SNMPX_SNMPOUTTOOBIGS:
        case SNMPX_SNMPOUTNOSUCHNAMES:
        case SNMPX_SNMPOUTBADVALUES:
        case SNMPX_SNMPOUTGENERRS:
        case SNMPX_SNMPOUTGETREQUESTS:
        case SNMPX_SNMPOUTGETNEXTS:
        case SNMPX_SNMPOUTSETREQUESTS:
        case SNMPX_SNMPOUTGETRESPONSES:
        case SNMPX_SNMPOUTTRAPS:
            if (oper == SNMPX_SET_OP)  /* READ ONLY */
                return LSA_NULL;
            break;
        case SNMPX_SNMPENABLEAUTHENTRAPS:
            if (oper == SNMPX_SET_OP)  /* SET operation not supported */
                return LSA_NULL;
            break;
        default:
            SNMPX_SNMPERROR("snmpx_var_snmp(): Unknown magic number");
            return LSA_NULL;    /* default FAIL return.*/
    }

    return(cp + vp->magic);   /* MIB_COUNTERS */
}


/* Following is a list of traps that can be sent.
   NOTIFICATION-TYPE macro in RFCs enlist the OBJECTs
   to be sent in a specific trap. So when a specific
   trap is to be sent, SNMP will pick varbinds from
   these structures.
*/
/*
struct trapVar nt_lldpRemTablesChange[4] = {
    {{1,0,8802,1,1,2,1,2,2,0xFF},   10, 0,0,LSA_NULL,0 },
    {{1,0,8802,1,1,2,1,2,3,0xFF},   10, 0,0,LSA_NULL,0 },
    {{1,0,8802,1,1,2,1,2,4,0xFF},   10, 0,0,LSA_NULL,0 },
    {{1,0,8802,1,1,2,1,2,5,0xFF},   10, 0,0,LSA_NULL,0 },
};
struct trapVar nt_risingAlarm[5] = {
    {{1,3,6,1,2,1,16,3,1,1,1,0xFF}, 12, 0,0,LSA_NULL,0 },
    {{1,3,6,1,2,1,16,3,1,1,3,0xFF}, 12, 0,0,LSA_NULL,0 },
    {{1,3,6,1,2,1,16,3,1,1,4,0xFF}, 12, 0,0,LSA_NULL,0 },
    {{1,3,6,1,2,1,16,3,1,1,5,0xFF}, 12, 0,0,LSA_NULL,0 },
    {{1,3,6,1,2,1,16,3,1,1,7,0xFF}, 12, 0,0,LSA_NULL,0 },
};
struct trapVar nt_fallingAlarm[5] = {
    {{1,3,6,1,2,1,16,3,1,1,1,0xFF}, 12, 0,0,LSA_NULL,0 },
    {{1,3,6,1,2,1,16,3,1,1,3,0xFF}, 12, 0,0,LSA_NULL,0 },
    {{1,3,6,1,2,1,16,3,1,1,4,0xFF}, 12, 0,0,LSA_NULL,0 },
    {{1,3,6,1,2,1,16,3,1,1,5,0xFF}, 12, 0,0,LSA_NULL,0 },
    {{1,3,6,1,2,1,16,3,1,1,8,0xFF}, 12, 0,0,LSA_NULL,0 },
};
*/

/* Following is a List of new TEXTUAL CONVENTIONS defined
   in the MIBs
*/
struct enumList snmpx_en_TruthValue[] =
{
    { "true", 1 },
    { "false", 2 },
    { LSA_NULL, 0 }
};

struct enumList snmpx_en_RowStatus[] =
{
    { "active", 1 },
    { "notInService", 2 },
    { "notReady", 3 },
    { "createAndGo", 4 },
    { "createAndWait", 5 },
    { "destroy", 6 },
    { LSA_NULL, 0 }
};

struct enumList snmpx_en_StorageType[] =
{
    { "other", 1 },
    { "volatile", 2 },
    { "nonVolatile", 3 },
    { "permanent", 4 },
    { "readOnly", 5 },
    { LSA_NULL, 0 }
};

struct enumList snmpx_en_SnmpSecurityLevel[] =
{
    { "noAuthNoPriv", 1 },
    { "authNoPriv", 2 },
    { "authPriv", 3 },
    { LSA_NULL, 0 }
};

struct enumList snmpx_en_EntryStatus[] =
{
    { "valid", 1 },
    { "createRequest", 2 },
    { "underCreation", 3 },
    { "invalid", 4 },
    { LSA_NULL, 0 }
};

struct enumList snmpx_en_AddressFamilyNumbers[] =
{
    { "other", 0 },
    { "ipV4", 1 },
    { "ipV6", 2 },
    { "nsap", 3 },
    { "hdlc", 4 },
    { "bbn1822", 5 },
    { "all802", 6 },
    { "e163", 7 },
    { "e164", 8 },
    { "f69", 9 },
    { "x121", 10 },
    { "ipx", 11 },
    { "appleTalk", 12 },
    { "decnetIV", 13 },
    { "banyanVines", 14 },
    { "e164withNsap", 15 },
    { "dns", 16 },
    { "distinguishedName", 17 },
    { "asNumber", 18 },
    { "xtpOverIpv4", 19 },
    { "xtpOverIpv6", 20 },
    { "xtpNativeModeXTP", 21 },
    { "fibreChannelWWPN", 22 },
    { "fibreChannelWWNN", 23 },
    { "gwid", 24 },
    { "reserved", 65535 },
    { LSA_NULL, 0 }
};

#endif    /* SNMPX_CFG_SNMP_AGENT */

/* end of file snmpx_mibs.c */

